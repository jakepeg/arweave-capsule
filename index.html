<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kapsule</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.js"></script>
    <style>
      .shadow-subtle {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      }

      /* .text-lg {
        font-size: 2rem;
        line-height: 2.5rem;
    } */
    </style>
  </head>
  <body class="bg-[#121212] text-white font-sans">
    <!-- Hero Section -->
    <header class="flex justify-between items-center px-6 py-4">
      <div class="flex items-center space-x-2">
        <img src="logo.png" alt="Kapsule logo" class="w-6" />
        <span class="text-xl font-semibold">Kapsule</span>
      </div>
      <button id="connectWalletBtn" class="bg-[#00E0B8] text-black py-3 px-6 rounded-full font-semibold hover:bg-[#00C2A0] transition">
        Connect Wallet
      </button>
    </header>

    <section class="text-center py-20 px-4">
      <h1 class="text-4xl md:text-5xl font-bold mb-4">Future-proof memories and digital assets</h1>
      <h2 class="text-lg text-[#BBBBBB] mb-12 max-w-xl mx-auto">
        Create and share digital time capsules that unlock on a future date.
      </h2>
      <a href="create.html" class="mt-8 bg-[#00C2FF] text-black py-3 px-6 rounded-full font-semibold hover:bg-[#00AACC] transition">
        Create Time Capsule
      </a>
    </section>

    <!-- How It Works Section -->
    <section class="px-6 max-w-6xl mx-auto">
      <div class="text-center mb-12">
        <p class="text-lg md:text-xl text-[#BBBBBB] max-w-2xl mx-auto">
          It's easy, quick, and free to get started. All you need to do is:
        </p>
      </div>
      <div class="grid md:grid-cols-3 gap-6">
        <div class="bg-[#1E1E1E] shadow-subtle p-6 rounded-xl text-center relative">
          <span class="absolute top-4 left-6 bg-[#00C2FF] text-black font-bold rounded-full w-8 h-8 flex items-center justify-center text-lg">1</span>
          <div class="text-3xl mb-4">üñäÔ∏è</div>
          <h3 class="text-xl font-semibold mb-2">Create Capsule</h3>
          <p class="text-[#BBBBBB]">Write a message and upload files.</p>
        </div>
        <div class="bg-[#1E1E1E] shadow-subtle p-6 rounded-xl text-center relative">
          <span class="absolute top-4 left-6 bg-[#00C2FF] text-black font-bold rounded-full w-8 h-8 flex items-center justify-center text-lg">2</span>
          <div class="text-3xl mb-4">üìÖ</div>
          <h3 class="text-xl font-semibold mb-2">Set Unlock Date</h3>
          <p class="text-[#BBBBBB]">Choose the day it becomes accessible.</p>
        </div>
        <div class="bg-[#1E1E1E] shadow-subtle p-6 rounded-xl text-center relative">
          <span class="absolute top-4 left-6 bg-[#00C2FF] text-black font-bold rounded-full w-8 h-8 flex items-center justify-center text-lg">3</span>
          <div class="mb-4">
            <svg class="w-8 h-8 mx-auto text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <rect x="3" y="3" width="6" height="6" stroke="currentColor" stroke-width="2" fill="none"/>
              <rect x="15" y="3" width="6" height="6" stroke="currentColor" stroke-width="2" fill="none"/>
              <rect x="3" y="15" width="6" height="6" stroke="currentColor" stroke-width="2" fill="none"/>
              <rect x="10" y="10" width="4" height="4" stroke="currentColor" stroke-width="2" fill="none"/>
              <rect x="17" y="17" width="2" height="2" stroke="currentColor" stroke-width="2" fill="none"/>
            </svg>
          </div>
          <h3 class="text-xl font-semibold mb-2">Share or Gift</h3>
          <p class="text-[#BBBBBB]">Share a link or order a keepsake.</p>
        </div>
      </div>
    </section>

    <!-- Product Highlight -->
    <section class="py-20 px-6">
      <div class="max-w-4xl mx-auto p-8 text-center">
        <img src="keyring.png" alt="Kapsule Keepsake" class="mx-auto mb-6 w-64" />
        <h2 class="text-3xl font-bold mb-4">Gift a physical memory</h2>
        <p class="text-[#BBBBBB] mb-6">
          Order a custom-engraved keepsake with a scannable QR code that links to your capsule.
        </p>
      </div>
    </section>

    <!-- Privacy & Permanence Section -->
    <section class="py-2 px-6 max-w-6xl mx-auto">
<div class="bg-[#1E1E1E] text-white shadow-md rounded-xl p-8 flex flex-col md:flex-row gap-8 items-start">
  <!-- Left Column -->
  <div class="w-full md:w-1/3 space-y-4">
    <h2 class="text-xl font-bold border-b-2 border-[#00C2FF] inline-block pb-1">Built on Arweave</h2>
    <ul class="space-y-2 text-[#BBBBBB]">
      <li class="flex items-center gap-2"><i class="fas fa-network-wired text-[#00C2FF]"></i> Decentralized</li>
      <li class="flex items-center gap-2"><i class="fas fa-lock text-[#00C2FF]"></i> Secure</li>
      <li class="flex items-center gap-2"><i class="fas fa-user-secret text-[#00C2FF]"></i> Private</li>
      <li class="flex items-center gap-2"><i class="fas fa-infinity text-[#00C2FF]"></i> Permanent</li>
    </ul>
  </div>

  <!-- Right Column -->
  <div class="w-full md:w-2/3 text-[#BBBBBB] text-lg leading-relaxed">
    Your data is stored <strong>permanently</strong> on the Arweave network ‚Äî <strong>encrypted</strong>, <strong>decentralized</strong>, and <strong>censorship-resistant</strong>.
    It‚Äôs not controlled by Big Tech or a central authority, meaning <strong>you truly own your information</strong>.
    When you send a Kapsule, you‚Äôre placing your trust in an <strong>unstoppable, transparent system</strong> that ensures your memories and digital assets remain safe and accessible
    <strong>only when the time is right</strong>.
  </div>
</div>

    </section>

    <!-- Footer -->
    <footer class="py-10 text-center text-[#BBBBBB] text-sm">
      <div class="space-x-4 mb-2">
        <a href="mailto:hello@jakekemsley.com" class="hover:underline">Contact</a>
        <a href="https://arweave.org/" class="hover:underline">Arweave</a>
        <a href="https://github.com/jakepeg/arweave-capsule" class="hover:underline">GitHub</a>
      </div>
      &copy; 2025 Kapsule. All rights reserved.
    </footer>

    <script type="module">
import {
  createDataItemSigner
} from 'https://unpkg.com/@permaweb/aoconnect/dist/browser.js';
import {
  TurboFactory,
  ArconnectSigner,
} from 'https://unpkg.com/@ardrive/turbo-sdk/bundles/web.bundle.min.js';

let wallet = null;
let signer = null;
let turbo = null;

function showError(message) {
  alert(message); // Simple fallback for error display
}

async function connectWallet() {
  try {
    if (!window.arweaveWallet) {
      showError("ArConnect wallet extension not found. Please install it from https://www.arconnect.io");
      return;
    }
    await window.arweaveWallet.connect([
      'ACCESS_ADDRESS',
      'SIGN_TRANSACTION',
      'ACCESS_PUBLIC_KEY',
      'SIGNATURE'
    ]);
    wallet = await window.arweaveWallet.getActiveAddress();
    localStorage.setItem('arconnect_wallet', wallet); // Persist wallet
    signer = createDataItemSigner(window.arweaveWallet);
    const turboSigner = new ArconnectSigner(window.arweaveWallet);
    turbo = TurboFactory.authenticated({ signer: turboSigner });
    updateWalletUI(wallet);
  } catch (error) {
    showError('Failed to connect wallet: ' + (error.message || 'Unknown error'));
  }
}

function updateWalletUI(walletAddr) {
  const btns = [document.getElementById('connectWalletBtn'), document.getElementById('connectWalletBtnCTA')];
  btns.forEach(btn => {
    if (btn && walletAddr) {
      btn.textContent = walletAddr.slice(0, 6) + '...' + walletAddr.slice(-4);
      if (btn.classList) {
        btn.classList.remove('bg-[#00E0B8]', 'hover:bg-[#00C2A0]');
        btn.classList.add('bg-green-600', 'hover:bg-green-700', 'text-white');
      } else {
        console.warn('updateWalletUI: Button found but has no classList:', btn);
      }
    } else if (!btn) {
      console.warn('updateWalletUI: Button not found in DOM');
    }
  });
}

document.addEventListener('DOMContentLoaded', async function() {
  const btns = [document.getElementById('connectWalletBtn'), document.getElementById('connectWalletBtnCTA')];
  btns.forEach(btn => {
    if (btn) btn.addEventListener('click', connectWallet);
  });
  
  // Restore wallet state if present
  const savedWallet = localStorage.getItem('arconnect_wallet');
  if (savedWallet && window.arweaveWallet) {
    try {
      wallet = savedWallet;
      // Reinitialize signer and turbo
      signer = createDataItemSigner(window.arweaveWallet);
      const turboSigner = new ArconnectSigner(window.arweaveWallet);
      turbo = TurboFactory.authenticated({ signer: turboSigner });
      updateWalletUI(wallet);
    } catch (error) {
      console.error('Failed to restore wallet connection:', error);
      localStorage.removeItem('arconnect_wallet');
    }
  }
});
    </script>
  </body>
</html>
